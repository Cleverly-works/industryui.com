{"version":3,"sources":["../../../../../components/organisms/messaging/components/input/index.js"],"names":["React","useState","useRef","EditorState","defaultSuggestionsFilter","styled","MentionSuggestions","MessageNames","MessagingActions","MessagingEditor","messagingPlugins","MessagingSubscriber","useComponentCommunication","formStyle","MessagingInput","mentions","onChange","suggestions","setSuggestions","createEmpty","editorState","setEditorState","editor","onSearchChange","value","onAddMention","e","console","info","focusEditor","current","focus","handleChange","onActionRecieved","payload","action","CLEAR_INPUT","messageName","Messaging","MESSAGING_ACTION","onRecieve","subscriber","length","Wrapper","div","topMultiplier","props","MESSAGING","theme","inputFontSize","maxInputHeight"],"mappings":"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","sourcesContent":["/**\n * Components - Messaging\n */\n\n// React\nimport React, { useState, useRef } from 'react'\n\n// Draft JS\nimport { EditorState } from 'draft-js'\nimport { defaultSuggestionsFilter } from '@draft-js-plugins/mention'\n\n// Style\nimport styled from 'styled-components'\n\n// UI\nimport {\n  MentionSuggestions,\n  MessageNames,\n  MessagingActions,\n  MessagingEditor,\n  messagingPlugins,\n  MessagingSubscriber,\n  useComponentCommunication\n} from '../../../../'\n\nimport { formStyle } from '../../../../form/variables/style'\n\nexport const MessagingInput = ({ mentions, onChange }) => {\n  const [suggestions, setSuggestions] = useState(mentions ?? [])\n\n  // Draft-JS editor configuration\n  const [editorState, setEditorState] = useState(() =>\n    EditorState.createEmpty()\n  )\n  const editor = useRef(null)\n\n  // Check editor text for mentions\n  const onSearchChange = ({ value }) => {\n    setSuggestions(defaultSuggestionsFilter(value, mentions))\n  }\n\n  const onAddMention = (e) => {\n    console.info(e)\n  }\n\n  // Focus on editor window\n  const focusEditor = () => {\n    editor.current.focus()\n  }\n\n  const handleChange = (e) => {\n    onChange(e)\n    setEditorState(e)\n  }\n\n  const onActionRecieved = (payload) => {\n    switch (payload.action) {\n      case MessagingActions.CLEAR_INPUT:\n        setEditorState(EditorState.createEmpty())\n        break\n\n      default:\n        break\n    }\n  }\n\n  useComponentCommunication({\n    messageName: MessageNames.Messaging.MESSAGING_ACTION,\n    onRecieve: onActionRecieved,\n    subscriber: MessagingSubscriber\n  })\n\n  return (\n    <Wrapper\n      onClick={() => focusEditor()}\n      topMultiplier={suggestions?.length ?? 0}>\n      {mentions && (\n        <MentionSuggestions\n          onAddMention={onAddMention}\n          onSearchChange={onSearchChange}\n          suggestions={suggestions}\n        />\n      )}\n\n      <MessagingEditor\n        editorState={editorState}\n        onChange={handleChange}\n        plugins={messagingPlugins}\n        placeholder=\"Type here...\"\n        ref={editor}\n      />\n    </Wrapper>\n  )\n}\n\nconst Wrapper = styled.div`\n  [class*='mentionSuggestions'] {\n    top: ${({ topMultiplier }) => '-' + topMultiplier * 35 + 'px'} !important;\n  }\n  ${(props) => formStyle(props)}\n  font-size:${({ theme: { MESSAGING } }) => MESSAGING.inputFontSize};\n  width: calc(100% - 8rem);\n  max-height: ${({ theme: { MESSAGING } }) => MESSAGING.maxInputHeight};\n  overflow-y: auto;\n`\n"],"file":"index.js"}