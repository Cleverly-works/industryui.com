{"version":3,"sources":["../../../../components/organisms/messaging/container/container.js"],"names":["React","useState","array","func","number","object","string","DragAndDropable","FullPreview","MessageList","MessagingDragHover","MessagingSearch","MessagingSend","MessageNames","MessagingActions","MessagingCommunicationService","MessagingSubscriber","useComponentCommunication","styled","MessagingContainer","audienceItems","className","forwardForMessages","maxLength","mentions","menuForMessages","messages","messagesContainerHeight","onFilter","onHashtagClick","onMentionClick","onMessageSubmit","onSearch","replyForMessages","style","messagesConfig","hasForward","hasMenu","hasReply","Files","setFiles","length","hasMessage","sethasMessage","IsDragHoverOpen","setIsDragHoverOpen","onHover","onLeave","onDrop","e","send","name","Messaging","MESSAGING_ACTION","payload","action","SET_ATTACHMENTS_TO_NEW_MESSAGE","data","closeHoverPopup","files","handleRemoveFile","fileIndex","newFiles","splice","handleAttachSubmitClick","handleMessageRecieved","onAction","HASHTAG_CLICKED","MENTION_CLICKED","EDIT_MESSAGE","console","info","DELETE_MESSAGE","STAR_MESSAGE","messageName","onRecieve","subscriber","handleSubmit","messageToSend","CLEAR_INPUT","setTimeout","StyledContainer","div","MESSAGING","theme","containerBackground","propTypes","isRequired"],"mappings":"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","sourcesContent":["/**\n * Messaging/Container\n */\n\n// React\nimport React, { useState } from 'react'\nimport { array, func, number, object, string } from 'prop-types'\n\n// UI\nimport {\n  DragAndDropable,\n  FullPreview,\n  MessageList,\n  MessagingDragHover,\n  MessagingSearch,\n  MessagingSend,\n  MessageNames,\n  MessagingActions,\n  MessagingCommunicationService,\n  MessagingSubscriber,\n  useComponentCommunication\n} from '../../../'\n\n// Style\nimport styled from 'styled-components'\n\nexport const MessagingContainer = ({\n  audienceItems,\n  className,\n  forwardForMessages,\n  maxLength,\n  mentions,\n  menuForMessages,\n  messages,\n  messagesContainerHeight,\n  onFilter,\n  onHashtagClick,\n  onMentionClick,\n  onMessageSubmit,\n  onSearch,\n  replyForMessages,\n  style\n}) => {\n  const messagesConfig = {\n    ...(forwardForMessages && { hasForward: true }),\n    ...(menuForMessages && { hasMenu: true }),\n    ...(replyForMessages && { hasReply: true })\n  }\n\n  const [Files, setFiles] = useState([])\n  const [hasMessage, sethasMessage] = useState(messages && messages.length > 0)\n  const [IsDragHoverOpen, setIsDragHoverOpen] = useState(false)\n\n  const onHover = () => {\n    if (!IsDragHoverOpen) {\n      setIsDragHoverOpen(true)\n    }\n  }\n  const onLeave = () => {\n    setIsDragHoverOpen(false)\n  }\n  const onDrop = (e) => {\n    setFiles(e)\n    MessagingCommunicationService.send({\n      name: MessageNames.Messaging.MESSAGING_ACTION,\n      payload: {\n        action: MessagingActions.SET_ATTACHMENTS_TO_NEW_MESSAGE,\n        data: e\n      }\n    })\n  }\n  const closeHoverPopup = () => {\n    setFiles((files) => [])\n    setIsDragHoverOpen(false)\n    MessagingCommunicationService.send({\n      name: MessageNames.Messaging.MESSAGING_ACTION,\n      payload: {\n        action: MessagingActions.SET_ATTACHMENTS_TO_NEW_MESSAGE,\n        data: []\n      }\n    })\n  }\n\n  const handleRemoveFile = (fileIndex) => {\n    const newFiles = [...Files]\n    newFiles.splice(fileIndex, 1)\n    if (newFiles.length === 0) {\n      closeHoverPopup()\n      return\n    }\n    setFiles(newFiles)\n    MessagingCommunicationService.send({\n      name: MessageNames.Messaging.MESSAGING_ACTION,\n      payload: {\n        action: MessagingActions.SET_ATTACHMENTS_TO_NEW_MESSAGE,\n        data: newFiles\n      }\n    })\n  }\n\n  const handleAttachSubmitClick = () => {\n    MessagingCommunicationService.send({\n      name: MessageNames.Messaging.MESSAGING_ACTION,\n      payload: {\n        action: MessagingActions.SET_ATTACHMENTS_TO_NEW_MESSAGE,\n        data: Files\n      }\n    })\n  }\n\n  const handleMessageRecieved = () => {\n    if (hasMessage === false) {\n      sethasMessage(true)\n    }\n  }\n\n  const onAction = (payload) => {\n    switch (payload.action) {\n      case MessagingActions.HASHTAG_CLICKED:\n        onHashtagClick(payload.data)\n        break\n      case MessagingActions.MENTION_CLICKED:\n        onMentionClick(payload.data)\n        break\n      case MessagingActions.EDIT_MESSAGE:\n        console.info(payload.data)\n        break\n      case MessagingActions.DELETE_MESSAGE:\n        console.info(payload.data)\n        break\n      case MessagingActions.STAR_MESSAGE:\n        console.info(payload.data)\n        break\n\n      default:\n        break\n    }\n  }\n\n  useComponentCommunication({\n    messageName: MessageNames.Messaging.MESSAGING_ACTION,\n    onRecieve: onAction,\n    subscriber: MessagingSubscriber\n  })\n\n  const handleSubmit = (messageToSend) => {\n    onMessageSubmit(messageToSend)\n    MessagingCommunicationService.send({\n      name: MessageNames.Messaging.MESSAGING_ACTION,\n      payload: { action: MessagingActions.CLEAR_INPUT }\n    })\n\n    MessagingCommunicationService.send({\n      name: MessageNames.Messaging.MESSAGING_ACTION,\n      payload: {\n        action: MessagingActions.SET_ATTACHMENTS_TO_NEW_MESSAGE,\n        data: []\n      }\n    })\n    setIsDragHoverOpen(() => false)\n    setTimeout(() => {\n      setFiles((files) => [])\n    }, 500)\n  }\n\n  return (\n    <>\n      <FullPreview />\n      <DragAndDropable onFileDrop={onDrop} onHover={onHover} onLeave={onLeave}>\n        <MessagingSearch onFilter={onFilter} onSearch={onSearch} />\n\n        <StyledContainer\n          messagesContainerHeight={hasMessage ? messagesContainerHeight : 0}\n          className={className}\n          style={style}>\n          <MessageList\n            config={messagesConfig}\n            initialMessages={messages}\n            onMessageRecieved={handleMessageRecieved}\n          />\n        </StyledContainer>\n        <MessagingSend\n          audienceItems={audienceItems}\n          onSubmit={handleSubmit}\n          maxLength={maxLength}\n          mentions={mentions}\n        />\n        <MessagingDragHover\n          files={Files}\n          handleRemoveFile={handleRemoveFile}\n          isOpen={IsDragHoverOpen}\n          onClose={closeHoverPopup}\n          onSubmit={handleAttachSubmitClick}\n        />\n      </DragAndDropable>\n    </>\n  )\n}\nconst StyledContainer = styled.div`\n  background-color: ${({ theme: { MESSAGING } }) =>\n    MESSAGING.containerBackground};\n  height: ${({ messagesContainerHeight }) =>\n    messagesContainerHeight ? messagesContainerHeight + 'px' : '300px'};\n  overflow: hidden;\n  position: relative;\n\n  .ReactVirtualized__Grid {\n    outline: none;\n  }\n  .public-DraftStyleDefault-block {\n    margin: 0.25em 0;\n  }\n`\n\nMessagingContainer.propTypes = {\n  audienceItems: array,\n  className: string,\n  messages: array.isRequired,\n  messagesContainerHeight: number,\n  onFilter: func.isRequired,\n  onSearch: func.isRequired,\n  onMessageSubmit: func.isRequired,\n  style: object\n}\n"],"file":"container.js"}