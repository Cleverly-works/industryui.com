{"version":3,"sources":["../../components/utils/auth.js"],"names":["bcrypt","jwt","hashPassword","password","hashSync","validatePassword","user","compareSync","generateToken","data","config","sign","secret","expiresIn","validateToken","token","verify","key","algorithms","decodeToken","decode","getUserFromToken","headers","Authorization","split","decoded"],"mappings":"AAAA;AACA;AACA;AAEA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,GAAP,MAAgB,cAAhB;AAEA,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,QAAD,EAAc;AACxC,SAAOH,MAAM,CAACI,QAAP,CAAgBD,QAAhB,EAA0B,EAA1B,CAAP;AACD,CAFM;AAIP,OAAO,IAAME,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,IAAD,EAAOH,QAAP,EAAoB;AAClD,SAAOH,MAAM,CAACO,WAAP,CAAmBJ,QAAnB,EAA6BG,IAAI,CAACH,QAAlC,CAAP;AACD,CAFM;AAIP,OAAO,IAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACC,IAAD,EAAOC,MAAP,EAAkB;AAC7C,SAAOT,GAAG,CAACU,IAAJ,CAASF,IAAT,EAAeC,MAAM,CAACE,MAAtB,EAA8B;AAAEC,IAAAA,SAAS,EAAE;AAAb,GAA9B,CAAP;AACD,CAFM;AAIP,OAAO,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,KAAD,EAAQL,MAAR,EAAmB;AAC9C,SAAOT,GAAG,CAACe,MAAJ,CAAWD,KAAX,EAAkBL,MAAM,CAACO,GAAzB,EAA8B;AAAEC,IAAAA,UAAU,EAAE,CAAC,OAAD;AAAd,GAA9B,CAAP;AACD,CAFM;AAIP,OAAO,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACJ,KAAD,EAAW;AACpC,SAAOd,GAAG,CAACmB,MAAJ,CAAWL,KAAX,CAAP;AACD,CAFM;AAIP,OAAO,IAAMM,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,OAAD,EAAUZ,MAAV,EAAqB;AACnD,MAAI,CAACY,OAAO,CAACC,aAAb,EAA4B;AAC1B,WAAO,IAAP;AACD;;AAED,MAAMR,KAAK,GAAGO,OAAO,CAACC,aAAR,CAAsBC,KAAtB,CAA4B,GAA5B,EAAiC,CAAjC,CAAd;;AAEA,MAAI,CAACT,KAAL,EAAY;AACV,WAAO,IAAP;AACD;;AAED,MAAMU,OAAO,GAAGX,aAAa,CAACC,KAAD,EAAQL,MAAR,CAA7B;;AAEA,MAAI,CAACe,OAAD,IAAY,CAACA,OAAO,CAACnB,IAAzB,EAA+B;AAC7B,WAAO,IAAP;AACD;;AAED,SAAOmB,OAAO,CAACnB,IAAf;AACD,CAlBM","sourcesContent":["/**\n * Auth utils\n */\n\nimport bcrypt from 'bcryptjs'\nimport jwt from 'jsonwebtoken'\n\nexport const hashPassword = (password) => {\n  return bcrypt.hashSync(password, 10)\n}\n\nexport const validatePassword = (user, password) => {\n  return bcrypt.compareSync(password, user.password)\n}\n\nexport const generateToken = (data, config) => {\n  return jwt.sign(data, config.secret, { expiresIn: '14d' })\n}\n\nexport const validateToken = (token, config) => {\n  return jwt.verify(token, config.key, { algorithms: ['RS512'] })\n}\n\nexport const decodeToken = (token) => {\n  return jwt.decode(token)\n}\n\nexport const getUserFromToken = (headers, config) => {\n  if (!headers.Authorization) {\n    return null\n  }\n\n  const token = headers.Authorization.split(' ')[1]\n\n  if (!token) {\n    return null\n  }\n\n  const decoded = validateToken(token, config)\n\n  if (!decoded || !decoded.user) {\n    return null\n  }\n\n  return decoded.user\n}\n"],"file":"auth.js"}